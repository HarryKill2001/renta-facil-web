<div class="confirmation-page" *ngIf="!isLoading && !errorMessage; else loadingOrErrorTemplate">
  <div class="confirmation-content" *ngIf="reservation$ | async as reservation">
    <div class="confirmation-header">
      <div class="status-icon success">‚úÖ</div>
      <h1>Reserva confirmada</h1>
      <p class="confirmation-subtitle">Tu reserva ha sido procesada exitosamente</p>
    </div>

    <div class="confirmation-details">
      <div class="confirmation-number-section">
        <h2>N√∫mero de confirmaci√≥n</h2>
        <div class="confirmation-number">{{ reservation.confirmationNumber }}</div>
        <p class="confirmation-note">Guarda este n√∫mero para futuras consultas</p>
      </div>

      <div class="reservation-info">
        <div class="info-section">
          <h3>Informaci√≥n de la reserva</h3>
          
          <div class="info-grid">
            <div class="info-item">
              <span class="label">Estado:</span>
              <span class="value">
                <span class="status-badge" [ngClass]="getStatusClass(reservation.status)">
                  {{ getStatusDisplayName(reservation.status) }}
                </span>
              </span>
            </div>
            
            <div class="info-item">
              <span class="label">Fecha de inicio:</span>
              <span class="value">{{ reservation.startDate | date:'dd/MM/yyyy' }}</span>
            </div>
            
            <div class="info-item">
              <span class="label">Fecha de fin:</span>
              <span class="value">{{ reservation.endDate | date:'dd/MM/yyyy' }}</span>
            </div>
            
            <div class="info-item">
              <span class="label">Total:</span>
              <span class="value price">{{ formatPrice(reservation.totalPrice) }}</span>
            </div>
          </div>
        </div>

        <div class="info-section">
          <h3>Informaci√≥n del veh√≠culo</h3>
          
          <div class="vehicle-card">
            <div class="vehicle-image">
              <div class="placeholder-image">
                <span class="vehicle-icon">üöó</span>
              </div>
            </div>
            
            <div class="vehicle-details">
              <h4>{{ reservation.vehicle?.model || 'Informaci√≥n del veh√≠culo' }}</h4>
              <p class="vehicle-type">{{ reservation.vehicle?.type || 'Tipo de veh√≠culo' }}</p>
              <p class="vehicle-year">A√±o {{ reservation.vehicle?.year || 'N/A' }}</p>
              <p class="vehicle-price">{{ formatPrice(reservation.vehicle?.pricePerDay || 0) }} por d√≠a</p>
            </div>
          </div>
        </div>

        <div class="info-section">
          <h3>Informaci√≥n del cliente</h3>
          
          <div class="customer-info">
            <div class="customer-item">
              <span class="label">Nombre:</span>
              <span class="value">{{ reservation.customer?.name }}</span>
            </div>
            
            <div class="customer-item">
              <span class="label">Documento:</span>
              <span class="value">{{ reservation.customer?.documentNumber }}</span>
            </div>
            
            <div class="customer-item">
              <span class="label">Email:</span>
              <span class="value">{{ reservation.customer?.email }}</span>
            </div>
            
            <div class="customer-item">
              <span class="label">Tel√©fono:</span>
              <span class="value">{{ reservation.customer?.phone }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="action-buttons">
      <div class="primary-actions">
        <button 
          class="btn btn-danger"
          *ngIf="isCancellable(reservation.status)"
          (click)="cancelReservation(reservation.id)">
          Cancelar reserva
        </button>
        
        <button class="btn btn-outline" (click)="printConfirmation()">
          üñ®Ô∏è Imprimir
        </button>
        
        <button class="btn btn-outline" (click)="downloadPDF()">
          üìÑ Descargar PDF
        </button>
      </div>
      
      <div class="secondary-actions">
        <button class="btn btn-primary" (click)="goToVehicles()">
          Ver m√°s veh√≠culos
        </button>
      </div>
    </div>

    <div class="important-notes">
      <h3>Informaci√≥n importante</h3>
      
      <div class="notes-list">
        <div class="note-item">
          <span class="note-icon">üìã</span>
          <div class="note-content">
            <strong>Documentos requeridos:</strong> Presenta tu documento de identidad y licencia de conducir vigente al momento del recogido.
          </div>
        </div>
        
        <div class="note-item">
          <span class="note-icon">üïê</span>
          <div class="note-content">
            <strong>Horarios de recogida:</strong> Lunes a viernes de 8:00 AM a 6:00 PM, s√°bados de 9:00 AM a 5:00 PM.
          </div>
        </div>
        
        <div class="note-item">
          <span class="note-icon">üí≥</span>
          <div class="note-content">
            <strong>M√©todos de pago:</strong> Aceptamos efectivo, tarjetas de cr√©dito y d√©bito. Se requiere dep√≥sito de garant√≠a.
          </div>
        </div>
        
        <div class="note-item">
          <span class="note-icon">üìû</span>
          <div class="note-content">
            <strong>Contacto:</strong> Para cualquier consulta, ll√°manos al +57 300 123 4567 o escribe a info&#64;rentafacil.com
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #loadingOrErrorTemplate>
  <div class="loading-error-state">
    <div *ngIf="isLoading" class="loading-content">
      <div class="spinner-large"></div>
      <p>Cargando informaci√≥n de la reserva...</p>
    </div>
    
    <div *ngIf="errorMessage" class="error-content">
      <div class="error-icon">‚ùå</div>
      <h2>Error al cargar la reserva</h2>
      <p>{{ errorMessage }}</p>
      <button class="btn btn-primary" (click)="goToVehicles()">
        Volver a veh√≠culos
      </button>
    </div>
  </div>
</ng-template>